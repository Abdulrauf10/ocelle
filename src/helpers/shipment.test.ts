import { describe, expect, test } from 'vitest';

import { getClosestDeliveryDateByDate } from './shipment';

import { CalendarEvent } from '@/types';

const events: CalendarEvent[] = [
  {
    id: '20230102@1823.gov.hk',
    summary: 'The day following the first day of January',
    source: 'gov',
    start: new Date('2023-01-01T16:00:00.000Z'),
    end: new Date('2023-01-02T16:00:00.000Z'),
  },
  {
    id: '20230123@1823.gov.hk',
    summary: 'The second day of Lunar New Year',
    source: 'gov',
    start: new Date('2023-01-22T16:00:00.000Z'),
    end: new Date('2023-01-23T16:00:00.000Z'),
  },
  {
    id: '20230124@1823.gov.hk',
    summary: 'The third day of Lunar New Year',
    source: 'gov',
    start: new Date('2023-01-23T16:00:00.000Z'),
    end: new Date('2023-01-24T16:00:00.000Z'),
  },
  {
    id: '20230125@1823.gov.hk',
    summary: 'The fourth day of Lunar New Year',
    source: 'gov',
    start: new Date('2023-01-24T16:00:00.000Z'),
    end: new Date('2023-01-25T16:00:00.000Z'),
  },
  {
    id: '20230405@1823.gov.hk',
    summary: 'Ching Ming Festival',
    source: 'gov',
    start: new Date('2023-04-04T16:00:00.000Z'),
    end: new Date('2023-04-05T16:00:00.000Z'),
  },
  {
    id: '20230407@1823.gov.hk',
    summary: 'Good Friday',
    source: 'gov',
    start: new Date('2023-04-06T16:00:00.000Z'),
    end: new Date('2023-04-07T16:00:00.000Z'),
  },
  {
    id: '20230408@1823.gov.hk',
    summary: 'The day following Good Friday',
    source: 'gov',
    start: new Date('2023-04-07T16:00:00.000Z'),
    end: new Date('2023-04-08T16:00:00.000Z'),
  },
  {
    id: '20230410@1823.gov.hk',
    summary: 'Easter Monday',
    source: 'gov',
    start: new Date('2023-04-09T16:00:00.000Z'),
    end: new Date('2023-04-10T16:00:00.000Z'),
  },
  {
    id: '20230501@1823.gov.hk',
    summary: 'Labour Day',
    source: 'gov',
    start: new Date('2023-04-30T16:00:00.000Z'),
    end: new Date('2023-05-01T16:00:00.000Z'),
  },
  {
    id: '20230526@1823.gov.hk',
    summary: 'The Birthday of the Buddha',
    source: 'gov',
    start: new Date('2023-05-25T16:00:00.000Z'),
    end: new Date('2023-05-26T16:00:00.000Z'),
  },
  {
    id: '20230622@1823.gov.hk',
    summary: 'Tuen Ng Festival',
    source: 'gov',
    start: new Date('2023-06-21T16:00:00.000Z'),
    end: new Date('2023-06-22T16:00:00.000Z'),
  },
  {
    id: '20230701@1823.gov.hk',
    summary: 'Hong Kong Special Administrative Region Establishment Day',
    source: 'gov',
    start: new Date('2023-06-30T16:00:00.000Z'),
    end: new Date('2023-07-01T16:00:00.000Z'),
  },
  {
    id: '20230930@1823.gov.hk',
    summary: 'The day following the Chinese Mid-Autumn Festival',
    source: 'gov',
    start: new Date('2023-09-29T16:00:00.000Z'),
    end: new Date('2023-09-30T16:00:00.000Z'),
  },
  {
    id: '20231002@1823.gov.hk',
    summary: 'The day following National Day',
    source: 'gov',
    start: new Date('2023-10-01T16:00:00.000Z'),
    end: new Date('2023-10-02T16:00:00.000Z'),
  },
  {
    id: '20231023@1823.gov.hk',
    summary: 'Chung Yeung Festival',
    source: 'gov',
    start: new Date('2023-10-22T16:00:00.000Z'),
    end: new Date('2023-10-23T16:00:00.000Z'),
  },
  {
    id: '20231225@1823.gov.hk',
    summary: 'Christmas Day',
    source: 'gov',
    start: new Date('2023-12-24T16:00:00.000Z'),
    end: new Date('2023-12-25T16:00:00.000Z'),
  },
  {
    id: '20231226@1823.gov.hk',
    summary: 'The first weekday after Christmas Day',
    source: 'gov',
    start: new Date('2023-12-25T16:00:00.000Z'),
    end: new Date('2023-12-26T16:00:00.000Z'),
  },
  {
    id: '20240101@1823.gov.hk',
    summary: 'The first day of January',
    source: 'gov',
    start: new Date('2023-12-31T16:00:00.000Z'),
    end: new Date('2024-01-01T16:00:00.000Z'),
  },
  {
    id: '20240210@1823.gov.hk',
    summary: 'Lunar New Year’s Day',
    source: 'gov',
    start: new Date('2024-02-09T16:00:00.000Z'),
    end: new Date('2024-02-10T16:00:00.000Z'),
  },
  {
    id: '20240212@1823.gov.hk',
    summary: 'The third day of Lunar New Year',
    source: 'gov',
    start: new Date('2024-02-11T16:00:00.000Z'),
    end: new Date('2024-02-12T16:00:00.000Z'),
  },
  {
    id: '20240213@1823.gov.hk',
    summary: 'The fourth day of Lunar New Year',
    source: 'gov',
    start: new Date('2024-02-12T16:00:00.000Z'),
    end: new Date('2024-02-13T16:00:00.000Z'),
  },
  {
    id: '20240329@1823.gov.hk',
    summary: 'Good Friday',
    source: 'gov',
    start: new Date('2024-03-28T16:00:00.000Z'),
    end: new Date('2024-03-29T16:00:00.000Z'),
  },
  {
    id: '20240330@1823.gov.hk',
    summary: 'The day following Good Friday',
    source: 'gov',
    start: new Date('2024-03-29T16:00:00.000Z'),
    end: new Date('2024-03-30T16:00:00.000Z'),
  },
  {
    id: '20240401@1823.gov.hk',
    summary: 'Easter Monday',
    source: 'gov',
    start: new Date('2024-03-31T16:00:00.000Z'),
    end: new Date('2024-04-01T16:00:00.000Z'),
  },
  {
    id: '20240404@1823.gov.hk',
    summary: 'Ching Ming Festival',
    source: 'gov',
    start: new Date('2024-04-03T16:00:00.000Z'),
    end: new Date('2024-04-04T16:00:00.000Z'),
  },
  {
    id: '20240501@1823.gov.hk',
    summary: 'Labour Day',
    source: 'gov',
    start: new Date('2024-04-30T16:00:00.000Z'),
    end: new Date('2024-05-01T16:00:00.000Z'),
  },
  {
    id: '20240515@1823.gov.hk',
    summary: 'The Birthday of the Buddha',
    source: 'gov',
    start: new Date('2024-05-14T16:00:00.000Z'),
    end: new Date('2024-05-15T16:00:00.000Z'),
  },
  {
    id: '20240610@1823.gov.hk',
    summary: 'Tuen Ng Festival',
    source: 'gov',
    start: new Date('2024-06-09T16:00:00.000Z'),
    end: new Date('2024-06-10T16:00:00.000Z'),
  },
  {
    id: '20240701@1823.gov.hk',
    summary: 'Hong Kong Special Administrative Region Establishment Day',
    source: 'gov',
    start: new Date('2024-06-30T16:00:00.000Z'),
    end: new Date('2024-07-01T16:00:00.000Z'),
  },
  {
    id: '20240918@1823.gov.hk',
    summary: 'The day following the Chinese Mid-Autumn Festival',
    source: 'gov',
    start: new Date('2024-09-17T16:00:00.000Z'),
    end: new Date('2024-09-18T16:00:00.000Z'),
  },
  {
    id: '20241001@1823.gov.hk',
    summary: 'National Day',
    source: 'gov',
    start: new Date('2024-09-30T16:00:00.000Z'),
    end: new Date('2024-10-01T16:00:00.000Z'),
  },
  {
    id: '20241011@1823.gov.hk',
    summary: 'Chung Yeung Festival',
    source: 'gov',
    start: new Date('2024-10-10T16:00:00.000Z'),
    end: new Date('2024-10-11T16:00:00.000Z'),
  },
  {
    id: '20241225@1823.gov.hk',
    summary: 'Christmas Day',
    source: 'gov',
    start: new Date('2024-12-24T16:00:00.000Z'),
    end: new Date('2024-12-25T16:00:00.000Z'),
  },
  {
    id: '20241226@1823.gov.hk',
    summary: 'The first weekday after Christmas Day',
    source: 'gov',
    start: new Date('2024-12-25T16:00:00.000Z'),
    end: new Date('2024-12-26T16:00:00.000Z'),
  },
  {
    id: '20250101@1823.gov.hk',
    summary: 'The first day of January',
    source: 'gov',
    start: new Date('2024-12-31T16:00:00.000Z'),
    end: new Date('2025-01-01T16:00:00.000Z'),
  },
  {
    id: '20250129@1823.gov.hk',
    summary: 'Lunar New Year’s Day',
    source: 'gov',
    start: new Date('2025-01-28T16:00:00.000Z'),
    end: new Date('2025-01-29T16:00:00.000Z'),
  },
  {
    id: '20250130@1823.gov.hk',
    summary: 'The second day of Lunar New Year',
    source: 'gov',
    start: new Date('2025-01-29T16:00:00.000Z'),
    end: new Date('2025-01-30T16:00:00.000Z'),
  },
  {
    id: '20250131@1823.gov.hk',
    summary: 'The third day of Lunar New Year',
    source: 'gov',
    start: new Date('2025-01-30T16:00:00.000Z'),
    end: new Date('2025-01-31T16:00:00.000Z'),
  },
  {
    id: '20250404@1823.gov.hk',
    summary: 'Ching Ming Festival',
    source: 'gov',
    start: new Date('2025-04-03T16:00:00.000Z'),
    end: new Date('2025-04-04T16:00:00.000Z'),
  },
  {
    id: '20250418@1823.gov.hk',
    summary: 'Good Friday',
    source: 'gov',
    start: new Date('2025-04-17T16:00:00.000Z'),
    end: new Date('2025-04-18T16:00:00.000Z'),
  },
  {
    id: '20250419@1823.gov.hk',
    summary: 'The day following Good Friday',
    source: 'gov',
    start: new Date('2025-04-18T16:00:00.000Z'),
    end: new Date('2025-04-19T16:00:00.000Z'),
  },
  {
    id: '20250421@1823.gov.hk',
    summary: 'Easter Monday',
    source: 'gov',
    start: new Date('2025-04-20T16:00:00.000Z'),
    end: new Date('2025-04-21T16:00:00.000Z'),
  },
  {
    id: '20250501@1823.gov.hk',
    summary: 'Labour Day',
    source: 'gov',
    start: new Date('2025-04-30T16:00:00.000Z'),
    end: new Date('2025-05-01T16:00:00.000Z'),
  },
  {
    id: '20250505@1823.gov.hk',
    summary: 'The Birthday of the Buddha',
    source: 'gov',
    start: new Date('2025-05-04T16:00:00.000Z'),
    end: new Date('2025-05-05T16:00:00.000Z'),
  },
  {
    id: '20250531@1823.gov.hk',
    summary: 'Tuen Ng Festival',
    source: 'gov',
    start: new Date('2025-05-30T16:00:00.000Z'),
    end: new Date('2025-05-31T16:00:00.000Z'),
  },
  {
    id: '20250701@1823.gov.hk',
    summary: 'Hong Kong Special Administrative Region Establishment Day',
    source: 'gov',
    start: new Date('2025-06-30T16:00:00.000Z'),
    end: new Date('2025-07-01T16:00:00.000Z'),
  },
  {
    id: '20251001@1823.gov.hk',
    summary: 'National Day',
    source: 'gov',
    start: new Date('2025-09-30T16:00:00.000Z'),
    end: new Date('2025-10-01T16:00:00.000Z'),
  },
  {
    id: '20251007@1823.gov.hk',
    summary: 'The day following the Chinese Mid-Autumn Festival',
    source: 'gov',
    start: new Date('2025-10-06T16:00:00.000Z'),
    end: new Date('2025-10-07T16:00:00.000Z'),
  },
  {
    id: '20251029@1823.gov.hk',
    summary: 'Chung Yeung Festival',
    source: 'gov',
    start: new Date('2025-10-28T16:00:00.000Z'),
    end: new Date('2025-10-29T16:00:00.000Z'),
  },
  {
    id: '20251225@1823.gov.hk',
    summary: 'Christmas Day',
    source: 'gov',
    start: new Date('2025-12-24T16:00:00.000Z'),
    end: new Date('2025-12-25T16:00:00.000Z'),
  },
  {
    id: '20251226@1823.gov.hk',
    summary: 'The first weekday after Christmas Day',
    source: 'gov',
    start: new Date('2025-12-25T16:00:00.000Z'),
    end: new Date('2025-12-26T16:00:00.000Z'),
  },
];

describe('getClosestDeliveryDateByDate', async () => {
  test('04-21', () => {
    expect(getClosestDeliveryDateByDate(events, new Date('2024-04-17'))).toStrictEqual(
      new Date('2024-04-20T16:00:00.000Z')
    );
  });

  test('04-26', () => {
    expect(getClosestDeliveryDateByDate(events, new Date('2024-04-26'))).toStrictEqual(
      new Date('2024-04-30T16:00:00.000Z')
    );
  });
});
